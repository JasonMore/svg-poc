!function(){var e={exports:{}},t=e.exports;t._bootstrapTransform=function(e,t,r,n){var i=function(e,r,n,i){t(n,e,r,"left"),t(i,r,e,"right")},p=e.transformX=function(e,t){r(e),r(t);for(var l=[],o=0;o<t.length;o++){for(var f=t[o],s=[],u=0;u<e.length;){var a=[];if(i(e[u],f,s,a),u++,1!==a.length){if(0===a.length){for(var h=u;h<e.length;h++)n(s,e[h]);f=null;break}for(var d=p(e.slice(u),a),g=0;g<d[0].length;g++)n(s,d[0][g]);for(var c=0;c<d[1].length;c++)n(l,d[1][c]);f=null;break}f=a[0]}null!=f&&n(l,f),e=s}return[e,l]};e.transform=e.transform=function(e,r,n){if("left"!==n&&"right"!==n)throw Error("type must be 'left' or 'right'");return 0===r.length?e:1===e.length&&1===r.length?t([],e[0],r[0],n):"left"===n?p(e,r)[0]:p(r,e)[1]}};var r=e.exports={name:"text0",uri:"http://sharejs.org/types/textv0",create:function(e){if(null!=e&&"string"!=typeof e)throw Error("Initial data must be a string");return e||""}},n=function(e,t,r){return e.slice(0,t)+r+e.slice(t)},i=function(e){if("number"!=typeof e.p)throw Error("component missing position field");if("string"==typeof e.i==("string"==typeof e.d))throw Error("component needs an i or d field");if(e.p<0)throw Error("position cannot be negative")},p=function(e){for(var t=0;t<e.length;t++)i(e[t])};r.apply=function(e,t){var r;p(t);for(var i=0;i<t.length;i++){var l=t[i];if(null!=l.i)e=n(e,l.p,l.i);else{if(r=e.slice(l.p,l.p+l.d.length),l.d!==r)throw Error("Delete component '"+l.d+"' does not match deleted text '"+r+"'");e=e.slice(0,l.p)+e.slice(l.p+l.d.length)}}return e};var l=r._append=function(e,t){if(""!==t.i&&""!==t.d)if(0===e.length)e.push(t);else{var r=e[e.length-1];null!=r.i&&null!=t.i&&r.p<=t.p&&t.p<=r.p+r.i.length?e[e.length-1]={i:n(r.i,t.p-r.p,t.i),p:r.p}:null!=r.d&&null!=t.d&&t.p<=r.p&&r.p<=t.p+t.d.length?e[e.length-1]={d:n(t.d,r.p-t.p,r.d),p:t.p}:e.push(t)}};r.compose=function(e,t){p(e),p(t);for(var r=e.slice(),n=0;n<t.length;n++)l(r,t[n]);return r},r.normalize=function(e){var t=[];(null!=e.i||null!=e.p)&&(e=[e]);for(var r=0;r<e.length;r++){var n=e[r];null==n.p&&(n.p=0),l(t,n)}return t};var o=function(e,t,r){return null!=t.i?t.p<e||t.p===e&&r?e+t.i.length:e:e<=t.p?e:e<=t.p+t.d.length?t.p:e-t.d.length};r.transformCursor=function(e,t,r){for(var n="right"===r,i=0;i<t.length;i++)e=o(e,t[i],n);return e};var f=r._tc=function(e,t,r,n){if(i(t),i(r),null!=t.i)l(e,{i:t.i,p:o(t.p,r,"right"===n)});else if(null!=r.i){var p=t.d;t.p<r.p&&(l(e,{d:p.slice(0,r.p-t.p),p:t.p}),p=p.slice(r.p-t.p)),""!==p&&l(e,{d:p,p:t.p+r.i.length})}else if(t.p>=r.p+r.d.length)l(e,{d:t.d,p:t.p-r.d.length});else if(t.p+t.d.length<=r.p)l(e,t);else{var f={d:"",p:t.p};t.p<r.p&&(f.d=t.d.slice(0,r.p-t.p)),t.p+t.d.length>r.p+r.d.length&&(f.d+=t.d.slice(r.p+r.d.length-t.p));var s=Math.max(t.p,r.p),u=Math.min(t.p+t.d.length,r.p+r.d.length),a=t.d.slice(s-t.p,u-t.p),h=r.d.slice(s-r.p,u-r.p);if(a!==h)throw Error("Delete ops delete different text in the same region of the document");""!==f.d&&(f.p=o(f.p,r),l(e,f))}return e},s=function(e){return null!=e.i?{d:e.i,p:e.p}:{i:e.d,p:e.p}};r.invert=function(e){e=e.slice().reverse();for(var t=0;t<e.length;t++)e[t]=s(e[t]);return e},"undefined"==typeof require?t._bootstrapTransform(r,f,p,l):require("./helpers")._bootstrapTransform(r,f,p,l);var u=window.ottypes=window.ottypes||{},a=e.exports;u[a.name]=a,a.uri&&(u[a.uri]=a)}();