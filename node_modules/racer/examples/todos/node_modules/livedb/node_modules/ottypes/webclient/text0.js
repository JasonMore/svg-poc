(function(){var e={exports:{}},t=e.exports,n=e.exports={name:"text0",uri:"http://sharejs.org/types/textv0",create:function(e){if(null!=e&&"string"!=typeof e)throw Error("Initial data must be a string");return e||""}},r=function(e,t,n){return e.slice(0,t)+n+e.slice(t)},p=function(e){if("number"!=typeof e.p)throw Error("component missing position field");if("string"==typeof e.i==("string"==typeof e.d))throw Error("component needs an i or d field");if(0>e.p)throw Error("position cannot be negative")},i=function(e){for(var t=0;e.length>t;t++)p(e[t])};n.apply=function(e,t){var n;i(t);for(var p=0;t.length>p;p++){var l=t[p];if(null!=l.i)e=r(e,l.p,l.i);else{if(n=e.slice(l.p,l.p+l.d.length),l.d!==n)throw Error("Delete component '"+l.d+"' does not match deleted text '"+n+"'");e=e.slice(0,l.p)+e.slice(l.p+l.d.length)}}return e};var l=n._append=function(e,t){if(""!==t.i&&""!==t.d)if(0===e.length)e.push(t);else{var n=e[e.length-1];null!=n.i&&null!=t.i&&n.p<=t.p&&t.p<=n.p+n.i.length?e[e.length-1]={i:r(n.i,t.p-n.p,t.i),p:n.p}:null!=n.d&&null!=t.d&&t.p<=n.p&&n.p<=t.p+t.d.length?e[e.length-1]={d:r(t.d,n.p-t.p,n.d),p:t.p}:e.push(t)}};n.compose=function(e,t){i(e),i(t);for(var n=e.slice(),r=0;t.length>r;r++)l(n,t[r]);return n},n.normalize=function(e){var t=[];(null!=e.i||null!=e.p)&&(e=[e]);for(var n=0;e.length>n;n++){var r=e[n];null==r.p&&(r.p=0),l(t,r)}return t};var o=function(e,t,n){return null!=t.i?e>t.p||t.p===e&&n?e+t.i.length:e:t.p>=e?e:t.p+t.d.length>=e?t.p:e-t.d.length};n.transformCursor=function(e,t,n){for(var r="right"===n,p=0;t.length>p;p++)e=o(e,t[p],r);return e};var d=n._tc=function(e,t,n,r){if(p(t),p(n),null!=t.i)l(e,{i:t.i,p:o(t.p,n,"right"===r)});else if(null!=n.i){var i=t.d;t.p<n.p&&(l(e,{d:i.slice(0,n.p-t.p),p:t.p}),i=i.slice(n.p-t.p)),""!==i&&l(e,{d:i,p:t.p+n.i.length})}else if(t.p>=n.p+n.d.length)l(e,{d:t.d,p:t.p-n.d.length});else if(t.p+t.d.length<=n.p)l(e,t);else{var d={d:"",p:t.p};t.p<n.p&&(d.d=t.d.slice(0,n.p-t.p)),t.p+t.d.length>n.p+n.d.length&&(d.d+=t.d.slice(n.p+n.d.length-t.p));var s=Math.max(t.p,n.p),u=Math.min(t.p+t.d.length,n.p+n.d.length),f=t.d.slice(s-t.p,u-t.p),h=n.d.slice(s-n.p,u-n.p);if(f!==h)throw Error("Delete ops delete different text in the same region of the document");""!==d.d&&(d.p=o(d.p,n),l(e,d))}return e},s=function(e){return null!=e.i?{d:e.i,p:e.p}:{i:e.d,p:e.p}};n.invert=function(e){e=e.slice().reverse();for(var t=0;e.length>t;t++)e[t]=s(e[t]);return e},"undefined"==typeof require?t._bootstrapTransform(n,d,i,l):require("./helpers")._bootstrapTransform(n,d,i,l);var u=window.ottypes=window.ottypes||{},f=e.exports;u[f.name]=f,f.uri&&(u[f.uri]=f)})();